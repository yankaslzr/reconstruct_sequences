Scripts used to extract msp2 variants and generate haplotype FASTA files.

Each script or command depends on the output generated by the previous step.

1. Generate the MSP2 variant table

File: command-line_generate_variants

This step extracts all variants overlapping the MSP2 locus from multiple
Mutect2 post-filtered VCF files and consolidates them into a single table.

Input: bgzipped and indexed VCF files (*.vcf.gz)

Output: msp2_variants.tsv

This file is required for all downstream steps.


2. Reconstruct MSP2 haplotype FASTA sequences

File: generate_fasta_msp2

This Python script:

- Loads the MSP2 reference sequence from the genome FASTA

- Reads the msp2_variants.tsv file

- Applies multiple allele-frequency (AF) thresholds

- Reconstructs one MSP2 sequence per sample and AF cutoff
  

Input:

- msp2_variants.tsv

- Pfalciparum.genome.fasta

Output: msp2_haplotypes_AFthresholds.fasta

FASTA headers include both the sample ID and the AF threshold.


3. Extract the MSP2 reference sequence

File: generate_ref_fasta

This step extracts the MSP2 reference sequence directly from the
P. falciparum 3D7 reference genome using samtools faidx.

Input: Pfalciparum.genome.fasta

Output: PF3D7_0206800_reference.fasta

The reference sequence can be appended to the samples' FASTA file to
facilitate alignment and comparative analyses.

--

4. To do the same for INDELS data, follow the steps in /scripts/generate_indels_file.
